/* src/components/BookSessionModal.css */
/* ====== Book Session MODAL — FIXED (no bleed, stacks like Reschedule) ====== */

/* Root overlay + modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.45);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
  padding: 20px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  box-sizing: border-box;
}

/* Generic modal content */
.modal-content {
  background: #fff;
  border-radius: 14px;
  width: min(720px, 100%);
  max-width: 98%;
  max-height: calc(100dvh - 48px);
  box-shadow: 0 20px 60px rgba(30, 58, 138, 0.18);
  border: 1px solid #e2e8f0;
  animation: fadeIn 0.25s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color: #0f172a;
  box-sizing: border-box;
  -webkit-overflow-scrolling: touch;
}

/* Book Session modal shell */
.modal-content.booksession-modal {
  background: #fff;
  border-radius: 14px;
  width: min(960px, 100%);
  max-width: 98%;
  max-height: calc(100dvh - 48px);
  box-shadow: 0 20px 60px rgba(30, 58, 138, 0.18);
  border: 1px solid #e2e8f0;
  animation: fadeIn 0.25s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color: #0f172a;
  box-sizing: border-box;
}

/* Form wrapper so body gets remaining height */
.modal-content.booksession-modal > form {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-height: 0;
}

/* Header */
.booksession-header {
  padding: 1.125rem 1.25rem 0.6rem 1.25rem;
  display: flex;
  justify-content: space-between;
  align-items: start;
  gap: 12px;
  flex: 0 0 auto;
  text-align: left;
}
.booksession-header h2 {
  margin: 0;
  font-size: 1.3rem;
  font-weight: 700;
  color: #1e3a8a;
  line-height: 1.05;
}
.booksession-header .meta {
  color: #374151;
  font-size: 16px;
}

/* Body (two columns) — zero-min tracks prevent overflow */
.booksession-body {
  display: grid;
  grid-template-columns: minmax(0, 500px) minmax(0, 1fr);
  gap: 20px;
  padding: 0 1.25rem 1.25rem 1.25rem;
  align-items: stretch;
  flex: 1 1 auto;
  min-height: 0;
  height: 100%;
  max-height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  box-sizing: border-box;
  scrollbar-width: thin;
  scrollbar-color: #94a3b8 #f1f5f9;
  overscroll-behavior: contain;
  touch-action: pan-y;
}
.booksession-body,
.booksession-body > *,
.calendar-panel,
.mac-calendar.compact,
.mac-calendar.compact table {
  min-width: 0;
  max-width: 100%;
}
.booksession-body::-webkit-scrollbar { width: 12px; }
.booksession-body::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 8px; }
.booksession-body::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 8px; }
.booksession-body::-webkit-scrollbar-thumb:hover { background: #64748b; }

/* Calendar panel */
.calendar-panel {
  display: flex;
  flex-direction: column;
  gap: 10px;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  padding: 10px;
  background: linear-gradient(180deg, #fff, #fbfdff);
  height: auto;
  min-height: 380px;
  box-sizing: border-box;
  text-align: left;
}
.calendar-panel.six-rows { min-height: 560px; }

/* Calendar controls */
.calendar-controls.compact {
  display: flex;
  gap: 10px;
  align-items: center;
  justify-content: center;
  margin-bottom: 8px;
}
.calendar-controls.compact button,
.calendar-controls.compact .nav-btn {
  background: transparent;
  border: 0;
  padding: 8px;
  font-size: 16px;
  color: var(--muted, #64748b);
  cursor: pointer;
  border-radius: 8px;
  transition: background 0.12s ease, transform 0.08s ease, box-shadow 0.12s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.calendar-controls.compact button:hover,
.calendar-controls.compact .nav-btn:hover {
  background: rgba(2, 6, 23, 0.03);
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(17, 24, 39, 0.04);
}
.calendar-controls .month-label,
.calendar-controls.compact .month-label {
  font-weight: 700;
  color: #0f172a;
  font-size: 0.95rem;
  padding: 4px 6px;
}

/* Calendar table */
.mac-calendar.compact {
  flex: 1 1 auto;
  width: 100%;
  overflow: visible;
  -webkit-overflow-scrolling: touch;
  box-sizing: border-box;
  scrollbar-width: thin;
  scrollbar-color: #94a3b8 #f8fafc;
  text-align: left;
}
.mac-calendar.compact::-webkit-scrollbar { height: 12px; width: 12px; }
.mac-calendar.compact::-webkit-scrollbar-track { background: #f8fafc; border-radius: 8px; }
.mac-calendar.compact::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 8px; }
.mac-calendar.compact::-webkit-scrollbar-thumb:hover { background: #64748b; }
.mac-calendar.compact table { width: 100%; border-collapse: collapse; table-layout: fixed; }
.mac-calendar.compact thead th {
  font-size: 11px;
  color: #64748b;
  padding: 8px 6px;
  text-align: left;
  font-weight: 700;
  background: transparent;
}
.mac-calendar.compact td { padding: 6px 6px; vertical-align: top; box-sizing: border-box; }

/* Square tile controls */
.cal-cell-small .cal-day-btn {
  display: inline-flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: flex-start;
  width: 100%;
  aspect-ratio: 1 / 1;
  padding: 10px;
  box-sizing: border-box;
  background: transparent;
  border: 0;
  cursor: pointer;
  border-radius: 8px;
  transition: background 0.12s ease, transform 0.08s ease, box-shadow 0.12s ease;
  text-align: left;
}
.cal-cell-small .cal-day-btn:hover { background: rgba(29, 78, 216, 0.06); }
.cal-cell-small.selected .cal-day-btn { background: rgba(29, 78, 216, 0.1); }
.cal-cell-small.disabled .cal-day-btn { opacity: 0.5; cursor: not-allowed; }
.cal-day-top { width: 100%; display: flex; justify-content: space-between; align-items: center; gap: 8px; }
.cal-day-num { font-weight: 700; color: #0f172a; line-height: 1; font-size: 1rem; }
.dot-block { width: 8px; height: 8px; border-radius: 50%; background: #f59e0b; flex: 0 0 8px; }
.cal-day-sub { margin-top: 6px; font-size: 11px; color: #6b7280; width: 100%; text-align: left; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.cal-cell-small .cal-day-btn:focus { outline: none; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.12); }

/* Calendar footer */
.calendar-footer {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin-top: 6px;
  font-size: 12px;
  color: #6b7280;
  flex: 0 0 auto;
}

/* Form panel (RIGHT) */
.form-panel {
  display: flex;
  flex-direction: column;
  gap: 8px;
  overflow: visible;
  box-sizing: border-box;
  padding: 0;
  min-height: 0;
  text-align: left;
}

/* Field stack */
.row {
  margin-top: 0.75rem;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  text-align: left;
}
.row.full { grid-column: 1 / -1; }

.label { display: block; font-weight: 600; color: #1e3a8a; font-size: 0.92rem; }
.control { margin-top: 6px; display: block; width: 100%; }
.control input, .control select, .control textarea { width: 100%; max-width: 100%; display: block; }

/* Inputs */
input, select, textarea {
  padding: 0.6rem 0.7rem;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  font-size: 0.95rem;
  transition: border-color 0.15s ease, box-shadow 0.15s ease;
}
input:focus, select:focus, textarea:focus {
  outline: none; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.12); border-color: #1d4ed8;
}
select { text-align: left; text-align-last: left; -moz-text-align-last: left; }

.small-note, .subtext { color: #6b7280; font-size: 12px; display: block; margin-top: 6px; }
.subtexts .subtext + .subtext { margin-top: 4px; }

/* Segmented control */
.segmented { display: inline-flex; justify-content: flex-start; align-self: flex-start; background: #eef2ff; border: 1px solid #c7d2fe; border-radius: 999px; overflow: hidden; width: auto; max-width: max-content; }
.seg { padding: 0.45rem 0.9rem; border: none; background: transparent; color: #1e3a8a; font-weight: 600; cursor: pointer; white-space: nowrap; text-align: left; }
.seg:not(.active):hover { background: rgba(29, 78, 216, 0.08); }
.seg.active { background: linear-gradient(135deg, #1e3a8a 0%, #1d4ed8 100%); color: #fff; }

/* Suggestions dropdown (for teammate input) */
.suggestions { position: absolute; top: calc(100% + 6px); left: 0; right: 0; max-height: 220px; overflow: auto; background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; box-shadow: 0 14px 28px rgba(2, 6, 23, 0.08); z-index: 5; }
.suggestion-item { padding: 10px 12px; font-size: 0.92rem; color: #0f172a; cursor: pointer; }
.suggestion-item:hover, .suggestion-item.active { background: #f8fafc; }

/* ===== Fancy select (custom dropdown for Duration/Time) ===== */
.fselect { position: relative; }
.fselect.fselect-open .fselect-trigger {
  border-color: #1d4ed8;
  box-shadow: 0 0 0 4px rgba(59,130,246,.12);
}
.fselect.fselect-disabled .fselect-trigger {
  background: #f8fafc; color: #94a3b8; cursor: not-allowed;
}
.fselect-trigger {
  display: flex; align-items: center; justify-content: space-between;
  width: 100%; padding: 0.6rem 0.7rem;
  background: #fff; border: 1px solid #cbd5e1; border-radius: 8px;
  font-size: .95rem; cursor: pointer; text-align: left;
  transition: border-color .15s ease, box-shadow .15s ease, background .12s ease;
}
.fselect-trigger:after {
  content: ""; margin-left: 8px; width: 10px; height: 10px;
  border-right: 2px solid #64748b; border-bottom: 2px solid #64748b;
  transform: rotate(45deg); transition: transform .12s ease; flex: 0 0 10px;
}
.fselect.fselect-open .fselect-trigger:after { transform: rotate(-135deg); }
.fselect-value { min-width: 0; flex: 1 1 auto; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
.fselect-menu {
  position: absolute; top: calc(100% + 6px); left: 0; right: 0;
  max-height: 240px; overflow: auto; background: #fff;
  border: 1px solid #e5e7eb; border-radius: 10px;
  box-shadow: 0 14px 28px rgba(2,6,23,.08); z-index: 6;
}
.fselect-option {
  padding: 10px 12px; font-size: .92rem; color: #0f172a; cursor: pointer;
  display: flex; align-items: center; justify-content: space-between;
}
.fselect-option:hover, .fselect-option.active { background: #f8fafc; }
.fselect-option[aria-selected="true"] { background: #eef2ff; color: #1e3a8a; font-weight: 700; }
.fselect-empty { padding: 10px 12px; font-size: .9rem; color: #6b7280; }

/* Actions */
.modal-actions { display: flex; justify-content: flex-start; gap: 8px; flex: 0 0 auto; padding-top: 12px; }
.btn { padding: 0.6rem 1rem; border-radius: 10px; font-weight: 700; cursor: pointer; margin-top: 0.5rem; border: 1px solid transparent; box-sizing: border-box; }
.btn-ghost { background: #f8fafc; border: 1px solid #e2e8f0; color: #0f172a; }
.btn-primary { background: linear-gradient(135deg, #1e3a8a 0%, #1d4ed8 100%); color: #fff; border: none; }
.btn-ghost:hover { background: rgba(15, 23, 42, 0.04); }
.btn-primary:hover { background: #1645b8; }

/* ===== Teammate LIST style (replaces chips if used) ===== */
.member-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 6px;
}
.member-row {
  display: grid;
  grid-template-columns: 40px 1fr auto;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  background: #ffffff;
  box-shadow: 0 6px 18px rgba(17, 24, 39, 0.04);
}
.member-avatar {
  width: 36px;
  height: 36px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 0.95rem;
  color: #1e3a8a;
  background: #eef2ff;
  border: 1px solid #c7d2fe;
}
.member-meta { min-width: 0; }
.member-name {
  font-weight: 700; color: #0f172a; font-size: 0.95rem; line-height: 1.1;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.member-email {
  font-size: 0.8rem; color: #6b7280; margin-top: 2px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.member-remove {
  border: 1px solid #e2e8f0; background: #f8fafc; border-radius: 8px;
  padding: 6px 10px; font-weight: 700; font-size: 0.85rem; color: #0f172a; cursor: pointer;
}
.member-remove:hover { background: rgba(15, 23, 42, 0.04); }
.more-toggle { margin-top: 8px; border: 0; background: transparent; color: #1d4ed8; font-weight: 700; cursor: pointer; padding: 0; }
.more-toggle:hover { text-decoration: underline; }

/* Scrollbar when expanded list overflows */
.member-list.expanded::-webkit-scrollbar { width: 10px; }
.member-list.expanded::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 8px; }
.member-list.expanded::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 8px; }
.member-list.expanded::-webkit-scrollbar-thumb:hover { background: #64748b; }

/* =========================
   Responsive
   ========================= */
@media (max-width: 895px) {
  .booksession-body {
    grid-template-columns: 1fr;
    gap: 12px;
    padding: 0 12px 12px 12px;
  }
  .booksession-modal .calendar-panel { min-height: 600px; }
  .booksession-modal .calendar-panel.six-rows { min-height: 720px; }
  .booksession-header { flex-direction: column; align-items: flex-start; gap: 8px; }
  .booksession-header .meta { margin-top: 2px; font-size: 14px; }
}

@media (max-width: 820px) {
  .modal-content.booksession-modal {
    width: calc(100% - 24px);
    max-width: calc(100% - 24px);
    max-height: calc(100dvh - 24px);
    border-radius: 12px;
  }
  .mac-calendar.compact { max-height: none; overflow: visible; }
  .calendar-panel { min-height: 520px; }
  .calendar-panel.six-rows { min-height: 640px; }
  .modal-actions { padding-bottom: 12px; }
}

@media (max-height: 600px) {
  .modal-overlay { padding: 8px; }
  .modal-content.booksession-modal { max-height: calc(100dvh - 16px); }
  .booksession-header { padding: 0.75rem 1rem 0.5rem 1rem; }
  .booksession-body { padding: 0 1rem 1rem 1rem; }
}

@media (max-width: 420px) {
  .booksession-header h2 { font-size: 1.08rem; font-weight: 700; }
  .booksession-header { gap: 6px; }
  .booksession-header .meta { margin-top: 3px; }
  .member-row { grid-template-columns: 32px 1fr auto; padding: 8px; }
  .member-avatar { width: 32px; height: 32px; font-size: 0.9rem; }
}

/* Animation */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-6px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ===== FINAL HARD OVERRIDES (kept) ===== */
.booksession-modal, .booksession-modal * { text-align: left !important; }
.booksession-modal .booksession-body { text-align: left !important; }
.booksession-modal .form-panel { padding-left: 0 !important; padding-right: 0 !important; text-align: left !important; }
.booksession-modal .form-panel .row { display: flex !important; flex-direction: column !important; align-items: stretch !important; justify-content: flex-start !important; text-align: left !important; }
.booksession-modal .form-panel .label { text-align: left !important; }
.booksession-modal .form-panel .control { width: 100% !important; margin-top: 6px !important; }
.booksession-modal .form-panel .control > input,
.booksession-modal .form-panel .control > select,
.booksession-modal .form-panel .control > textarea { width: 100% !important; max-width: 100% !important; display: block !important; }
.booksession-modal .form-panel select { text-align: left !important; text-align-last: left !important; -moz-text-align-last: left !important; }
.booksession-modal .form-panel .subtexts,
.booksession-modal .form-panel .subtext,
.booksession-modal .form-panel .small-note { text-align: left !important; }
.booksession-modal .form-panel .suggestions { left: 0 !important; right: 0 !important; }
.booksession-modal .form-panel .modal-actions { justify-content: flex-start !important; }
.booksession-modal .form-panel .row > *,
.booksession-modal .form-panel .control > * { margin-left: 0 !important; margin-right: 0 !important; }
.booksession-modal .form-panel .segmented { display: inline-flex !important; align-self: flex-start !important; justify-content: flex-start !important; width: auto !important; max-width: max-content !important; }
.booksession-modal .form-panel .segmented .seg { width: auto !important; text-align: left !important; white-space: nowrap !important; }

/* Optional tighter right-pane spacing */
.booksession-modal .form-panel .row { margin-top: -1.5rem !important; }
.booksession-modal .form-panel .control { margin-top: 0rem !important; }
.booksession-modal .form-panel .small-note,
.booksession-modal .form-panel .subtext { margin-top: 4px !important; }
.booksession-modal .form-panel .subtexts .subtext + .subtext { margin-top: 2px !important; }
.booksession-modal .form-title { margin: 0 0 8px 0 !important; font-size: 1.2rem !important; font-weight: 800 !important; color: #1e3a8a !important; }
.booksession-modal .form-panel .gap-after-type { margin-top: -10px !important; margin-bottom: 1rem !important; }
.booksession-modal .form-panel .gap-after-type + .group-block { margin-top: 4px !important; }
.booksession-modal .form-panel .gap-after-type + .row.field-row { margin-top: 12px !important; }

/* Keep month controls centered */
.booksession-modal .calendar-controls.compact { justify-content: center !important; }

/* Tighter spacing when Teammates appears */
.booksession-modal .form-panel .gap-after-type { margin-top: -10px !important; margin-bottom: 0 !important; }
.booksession-modal .form-panel .gap-after-type + .group-block { margin-top: 4px !important; }
.booksession-modal .form-panel .gap-after-type + .row.field-row { margin-top: 12px !important; }

/* Align "Added" and "Clear all" perfectly */
.member-summary {
  margin-top: 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.booksession-modal .member-summary .subtext { margin-top: 0 !important; line-height: 1.25; }

/* Extra room under "Show N more"/"Collapse" */
.more-toggle { margin-top: 8px; }

/* Space between Teammates block and the next field (Duration) */
.booksession-modal .form-panel .group-block + .row.field-row { margin-top: 0rem !important; }

/* Align label + Clear all better */
.booksession-modal .member-summary { align-items: baseline !important; }

/* Nudge Clear all up by overriding the global .btn margin */
.booksession-modal .member-summary .btn.member-clear {
  margin-top: 0 !important;
  height: 32px; line-height: 1; padding: 6px 10px;
  display: inline-flex; align-items: center; transform: translateY(-2px);
}

/* === Wider modal on smaller screens (overrides) === */
@media (max-width: 820px) {
  .modal-overlay { padding: 12px; }
  .modal-content.booksession-modal {
    width: 100%;
    max-width: 100%;
    max-height: calc(100dvh - 24px);
    border-radius: 12px;
  }
}

@media (max-width: 640px) {
  .modal-overlay { padding: 8px; }
  .modal-content.booksession-modal {
    width: 100%;
    max-width: 100%;
    max-height: calc(100dvh - 16px);
    border-radius: 10px;
  }
  /* tighten inner padding a bit for more usable space */
  .booksession-body { padding: 0 10px 10px 10px; }
}

@media (max-width: 420px) {
  .modal-overlay { padding: 6px; }
  .modal-content.booksession-modal {
    width: 100%;
    max-width: 100%;
    max-height: calc(100dvh - 12px);
    border-radius: 10px;
  }
}

/* iOS safe-area guards so the modal really hits the edges without clipping */
@supports (padding: max(0px)) {
  @media (max-width: 640px) {
    .modal-overlay {
      padding-left: max(8px, env(safe-area-inset-left));
      padding-right: max(8px, env(safe-area-inset-right));
    }
  }
}